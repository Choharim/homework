---
title: íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì±Œë¦°ì§€ - medium(1)
description: ReturnType, Omit, DeepReadonly ìœ í‹¸ íƒ€ì…ì„ ë§Œë“¤ì–´ë³´ì.
createDate: 2023.4.26
category: typescript
---

## í•¨ìˆ˜ì˜ ë¦¬í„´ íƒ€ì… ë§Œë“¤ê¸°

### ëª©í‘œ

ë‚´ì¥ ì œë„¤ë¦­Â `ReturnType<T>`ì„ ì´ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  í•¨ìˆ˜ì˜ ë¦¬í„´ íƒ€ì…ì„ êµ¬í˜„í•´ë³´ì.

```tsx
type cases = [
  Expect<Equal<string, MyReturnType<() => string>>>,
  Expect<Equal<123, MyReturnType<() => 123>>>,
  Expect<Equal<ComplexObject, MyReturnType<() => ComplexObject>>>,
  Expect<Equal<Promise<boolean>, MyReturnType<() => Promise<boolean>>>>,
  Expect<Equal<() => 'foo', MyReturnType<() => () => 'foo'>>>,
  Expect<Equal<1 | 2, MyReturnType<typeof fn>>>,
  Expect<Equal<1 | 2, MyReturnType<typeof fn1>>>
]

type ComplexObject = {
  a: [12, 'foo']
  bar: 'hello'
  prev(): number
}

const fn = (v: boolean) => (v ? 1 : 2)
const fn1 = (v: boolean, w: any) => (v ? 1 : 2)
```

### êµ¬í˜„

1. ì œë„¤ë¦­ìœ¼ë¡œ í•¨ìˆ˜ íƒ€ì…ì„ ë°›ì•„ì•¼ í•œë‹¤.

```tsx
type MyReturnType<T extends Function> = ...
```

2. ë§¤ê°œë³€ìˆ˜ê°€ ì—¬ëŸ¬ê°œë¡œ êµ¬ì„±ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë°°ì—´ íƒ€ì…ì´ì–´ì•¼ í•œë‹¤.  
   í•¨ìˆ˜ì˜ ë¦¬í„´ íƒ€ì…ì„ ë°˜í™˜í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— infer íƒ€ì… ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.

```tsx
type MyReturnType<T extends Function> = T extends (
  ...arg: Array<any>
) => infer R
  ? R
  : never
```

â—Â ë§¤ê°œë³€ìˆ˜ íƒ€ì…ì— unknownì„ ì‚¬ìš©í•œ ê²½ìš°ëŠ” í‹€ë¦¬ë‹¤. ë§¤ê°œë³€ìˆ˜ì— ëŒ€í•œ íƒ€ì…ì„ ì¶”ë¡ í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.  
ë°˜ë©´, anyëŠ” ì–´ë–¤ ê°’ì´ë“  í• ë‹¹í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë§¤ê°œë³€ìˆ˜ íƒ€ì…ì— ëŒ€í•œ ì •ë³´ê°€ ì—†ì–´ë„ íƒ€ì… ì¶”ë¡ ì´ ê°€ëŠ¥í•˜ë‹¤.

```tsx
// âŒ
type MyReturnType<T extends Function> = T extends (
  ...arg: Array<unknown>
) => infer R
  ? R
  : never
```

```tsx
const fn = (v: boolean) => (v ? 1 : 2)
type Test1 = typeof fn extends (...args: unknown[]) => infer R ? true : false // false
type Test2 = typeof fn extends (...args: any[]) => infer R ? true : false // true
```

## Omit íƒ€ì… ë§Œë“¤ê¸°

### ëª©í‘œ

Omit íƒ€ì…ì„ êµ¬í˜„í•´ë³´ì.

### êµ¬í˜„

1. ë‘ë²ˆì§¸ ì œë„¤ë¦­ì—ëŠ” ì²«ë²ˆì§¸ ì œë„¤ë¦­ íƒ€ì…ì˜ keyê°€ ì™€ì•¼í•œë‹¤.

```tsx
type MyOmit<T, K extends keyof T> = ...
```

2. ê°€ëŠ¥í•œ key íƒ€ì…ë§Œ ë§¤í•‘í•œë‹¤.

```tsx
type MyOmit<T, K extends keyof T> = { [key in Key<keyof T, K>]: T[key] }
```

3. Key íƒ€ì…ì˜ ì²«ë²ˆì§¸ Union íƒ€ì…ì´ ì œê±°í•  íƒ€ì…ì„ í¬í•¨í•˜ë©´ íƒ€ì…ì´ ì¡´ì¬í•˜ì§€ ì•Šì•„ì•¼ í•˜ë¯€ë¡œ neverì´ì–´ì•¼ í•œë‹¤.
   1. Key ì œë„¤ë¦­ì—ì„œ TëŠ” Union íƒ€ì…ì´ê³ , ê° íƒ€ì…ì„ ìˆœì°¨ì ìœ¼ë¡œ Uì˜ ë¶€ë¶„ì§‘í•©ì¸ì§€ í™•ì¸í•œë‹¤.
   2. ë¶€ë¶„ ì§‘í•©ì´ë¼ë©´ never ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ í•´ë‹¹ íƒ€ì…ì„ ë°˜í™˜í•œë‹¤.
   3. Unionìœ¼ë¡œ ì—°ê²°ë˜ë©´ì„œ never íƒ€ì…ì€ ì œê±°ëœë‹¤.
   4. ìµœì¢…ì ìœ¼ë¡œ neverê°€ ëœ íƒ€ì…ì€ ì œê±°ë˜ê³  ë‚¨ì€ íƒ€ì…ë§Œ keyì— ë§¤í•‘ëœë‹¤.

```tsx
type Key<T, U> = T extends U ? never : T
type MyOmit<T, K extends keyof T> = { [key in Key<keyof T, K>]: T[key] }
```

â—Â ì•„ë˜ì˜ ë°©ë²•ì€ í‹€ë¦¬ë‹¤.
keyof T extends Kê°€ falseì¼ ë•Œ keyof Tê°€ ë˜ë¯€ë¡œ ì—¬ì „íˆ ëª¨ë“  keyë¡œ ë§¤í•‘í•˜ê²Œ ëœë‹¤.

```tsx
type MyOmit<T, K extends keyof T> = {
  [key in keyof T extends K ? never : keyof T]: T[key]
}
```

â•Â ë‹¤ë¥¸ ë°©ë²•

keyof T íƒ€ì…ì€ keyë¡œ ë§¤í•‘ ë˜ë¯€ë¡œ keyof T íƒ€ì…ì„ ë‹¨ì–¸í•´ ì ìš©í•  ìˆ˜ë„ ìˆë‹¤.

```tsx
type MyOmit<T, K extends keyof T> = {
  [key in keyof T as key extends K ? never : key]: T[key]
}
```

## ê°ì²´ì˜ ëª¨ë“  í”„ë¡œí¼í‹°ë¥¼ ì½ê¸° ì „ìš©ìœ¼ë¡œ ë§Œë“œëŠ” **Deep Readonly íƒ€ì… ë§Œë“¤ê¸°**ğŸ”¥

### ëª©í‘œ

íŠ¹ì • keyë§Œ readonly íƒ€ì…ìœ¼ë¡œ ì§€ì •í•˜ëŠ” Readonly íƒ€ì…ì„ êµ¬í˜„í•´ë³´ì.
MyReadonly2ì—ì„œ Kê°€ ì£¼ì–´ì§€ì§€ ì•Šìœ¼ë©´ Tì „ì²´ keyë¥¼ readonlyë¡œ ë³€ê²½í•˜ê³ ,
Kê°€ ì£¼ì–´ì§€ë©´ K keyë§Œ readonlyë¡œ ë³€ê²½í•˜ì.

```tsx
interface Todo1 {
  title: string
  description?: string
  completed: boolean
}

MyReadonly2 < Todo1,
  'title' |
    ('description' > // titleê³¼ description keyë§Œ readonly
      MyReadonly2<Todo1>) // Readonly<Todo1>ì™€ ë™ì¼
```

### êµ¬í˜„

1. ë‘ë²ˆì§¸ ì œë„¤ë¦­ì€ ì²«ë²ˆì§¸ ê°ì²´ keyì˜ ë¶€ë¶„ì§‘í•©ì´ë‹¤.

```tsx
type MyReadonly2<T, K extends keyof T> = ...
```

2. ë‘ë²ˆì§¸ ì œë„¤ë¦­ì€ ì£¼ì–´ì§€ì§€ ì•Šì•„ë„ ë˜ë¯€ë¡œ ê¸°ë³¸ê°’ì„ ì„¤ì •í•œë‹¤.
   ë‘ë²ˆì§¸ ì œë„¤ë¦­ì˜ Union íƒ€ì…ì´ readonlyê°€ ë˜ì–´ì•¼ í•˜ê³ , ë‘ë²ˆì§¸ ì œë„¤ë¦­ì´ ì£¼ì–´ì§€ì§€ ì•Šì•˜ì„ ë•Œ ëª¨ë“  keyê°€ readonlyê°€ ë˜ì–´ì•¼ í•˜ë¯€ë¡œ keyof Tê°€ ê¸°ë³¸ê°’ì´ ëœë‹¤.

```tsx
type MyReadonly2<T, K extends keyof T = keyof T> = ...
```

3. ë‘ë²ˆì§¸ ì œë„¤ë¦­ íƒ€ì…ì´ keyë¡œ ë§¤í•‘ë˜ì—ˆì„ ë•Œ readonlyê°€ ë˜ì–´ì•¼ í•œë‹¤.

```tsx
type MyReadonly2<T, K extends keyof T =  keyof T> = { readonly [key in K] : T[key]} & ...
```

4. ë‚˜ë¨¸ì§€ í•„ë“œë„ ì¶”ê°€í•´ì•¼ í•œë‹¤.

```tsx
type MyReadonly2<T, K extends keyof T = keyof T> = {
  readonly [key in K]: T[key]
} & { [key in keyof T as key extends K ? never : key]: T[key] }
```

Omit ìœ í‹¸ íƒ€ì…ì„ ì‚¬ìš©í•˜ë©´ ê°„ë‹¨íˆ í•  ìˆ˜ ìˆë‹¤.

```tsx
type MyReadonly2<T, K extends keyof T = keyof T> = {
  readonly [key in K]: T[key]
} & Omit<T, K>
```

### ëª©í‘œ

ê°ì²´ì˜ í”„ë¡œí¼í‹°ì™€ ëª¨ë“  í•˜ìœ„ ê°ì²´ë¥¼ ì¬ê·€ì ìœ¼ë¡œ ì½ê¸° ì „ìš©ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ì œë„¤ë¦­Â `DeepReadonly<T>`
ë¥¼ êµ¬í˜„í•´ë³´ì.

### êµ¬í˜„

ê°ì²´ì˜ keyë¥¼ readonlyë¡œ ì§€ì •í•œë‹¤. ê°ì²´ì˜ valueë¥¼ ì œë„¤ë¦­ìœ¼ë¡œ ë„˜ê²¨ ì¬ê·€ì ìœ¼ë¡œ ì´ë¥¼ ë°˜ë³µí•œë‹¤.
ì œë„¤ë¦­ íƒ€ì…ì´ objectê°€ ì•„ë‹ˆë©´ í•´ë‹¹ íƒ€ì…ì„ ê·¸ëŒ€ë¡œ ë°˜í™˜í•œë‹¤.

```tsx
// âŒ
type DeepReadonly<T> = T extends object
  ? { readonly [key in keyof T]: DeepReadonly<T[key]> }
  : T
```

```tsx
// âŒ
type DeepReadonly<T extends object> = {
  readonly [key in keyof T]: T[key] extends object
    ? DeepReadonly<T[key]>
    : T[key]
}
```

âš ï¸Â Functionë„ objectì˜ ë¶€ë¶„ì§‘í•©ì´ê¸° ë•Œë¬¸ì— extends ì¡°ê±´ë¬¸ì—ì„œ trueê°€ ë˜ì–´ `DeepReadonly<T[key]>` íƒ€ì…ì´ ëœë‹¤.

ê·¸ë˜ì„œ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½í–ˆë‹¤.

```tsx
type DeepReadonly<T extends object> = T extends Function
  ? T
  : {
      readonly [key in keyof T]: T[key] extends object
        ? DeepReadonly<T[key]>
        : T[key]
    }
```

ê·¼ë° ìœ„ì˜ ë°©ë²•ì€ ê¹”ë”í•˜ì§€ ì•Šë‹¤. ê°„ê²°í•˜ê²Œ ë³€ê²½í•´ë³´ì.

```tsx
type DeepReadonly<T> = {
  readonly [key in keyof T]: keyof T[key] extends never
    ? T[key]
    : DeepReadonly<T[key]>
}
```

valueì˜ keyê°€ never íƒ€ì…ì´ë©´ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ê³ , never íƒ€ì…ì´ ì•„ë‹ˆë¼ë©´ ì¬ê·€ íƒ€ì…ì„ ë°˜í™˜í•œë‹¤.
ì—¬ê¸°ì„œ, valueì˜ keyê°€ never íƒ€ì…ì´ ì•„ë‹ˆë¼ëŠ” ê²Œ key-valueë¥¼ ê°–ëŠ” ê°ì²´ íƒ€ì…ì´ë¼ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.
Function, number, string, boolean ë“±ë„ key íƒ€ì…ì„ ê°–ëŠ”ë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŠ” valueë¥¼ ê°–ì§€ ì•Šê¸° ë•Œë¬¸ì— í•œ ë²ˆ ë” DeepReadonly íƒ€ì…ì´ ë˜ì—ˆì„ ë•Œ keyof T[key] extends neverì—ì„œ falseê°€ ë˜ì–´ T[key] ìì‹ ì˜ value íƒ€ì…ì„ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ê²Œ ëœë‹¤.
